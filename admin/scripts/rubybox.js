!function(e){"use strict";window.rb01MODULE||(window.rb01MODULE={}),window.rb01VA||(window.rb01VA={codeName:"rubybox",codeData:"options",namespace:"rb01"}),e[rb01VA.codeName]=function(n,t){var i={$self:n,codekey:Math.ceil(1e9*Math.random()),ev:e("<div/>"),o:t},r=function(){o.checkInit(),(null==i.href||null==i.content)&&(s.init(),a.codeMain(),s.classSupport(),s.vaUpdate(),f.begin(),f.keyboard())},o={checkInit:function(){var e=this;i.isOpacity=e.testCSS("opacity"),i.isTf3D=e.testCSS("perspective"),i.isTs=e.testCSS("transition"),i.prefixTf=e.prefix("transform"),i.prefixTs=e.prefix("transition"),i.href=null!=t.href?t.href:n.attr("href")?n.attr("href"):null,i.content=null!=t.content?t.content:n.data("content")?n.data("content"):null},autoCheckType:function(){var n=i.ns+"content",r=function(e,n){if(null==i.type)if(null==e)i.type=n;else{var t=i.href.match(e);null!=t&&t[0]&&(i.type=n)}};null!=i.href?(i.href=i.href.replace(/(^\s+|\s+$)/g,""),i.type="auto"==t.type?null:t.type,r(/\.(jpg|jpeg|png|gif|ico)$/g,"image"),r(/^(\#|\.\w+)/gi,"inline"),"inline"==i.type&&(i.$content=e(i.href).addClass(n))):r(null,"html"),r(null,"media")},camelCase:function(e){return e.replace(/-([a-z])/gi,function(e,n){return n.toUpperCase()})},testCSS:function(e,n){var t=document.createElement("p").style,i="Webkit Moz ms O".split(" "),r="-webkit- -moz- -ms- -o-".split(" "),o=this.camelCase(e);if(void 0!=t[o])return n?"":!0;for(var s=o.charAt(0).toUpperCase()+o.slice(1),a=0,c=i.length;c>a;a++)if(void 0!=t[i[a]+s])return n?r[a]:!0;return!1},prefix:function(e){return this.testCSS(e,!0)},isNum:function(e){return"number"==typeof e},tf:function(e){var n={},t="";return null!=e[0]&&(t+="translate3d("+e[0]+"px,"+e[1]+"px,0) "),null!=e[2]&&(t+="scale("+e[2]+","+e[3]+") "),n[i.prefixTf+"transform"]=t,n}},s={init:function(){var r=rb01VA.codeData,s=n.data(r);"string"==typeof s&&(s=s.replace(/\u0027/g,'"'),s=e.parseJSON(s)),s=e.isPlainObject(s)?s:{},i.o=t=e.extend(!0,t,s),n.removeAttr("data-"+r),i.ns=rb01VA.namespace,i.actived=i.ns+"actived",i.classTemp=" ",o.autoCheckType(),rb01VA.nLink?rb01VA.nLink++:rb01VA.nLink=1;var a="."+i.ns+i.codekey;i.evName={click:"click"+a,resize:"resize"+a,key:"keyup"+a}},classSupport:function(){var e=i.ns+(i.isOpacity?"":"no-")+"opacity",n=i.ns+(i.isTs?"":"no-")+"transition";i.$wrap.addClass(e+" "+n)},vaUpdate:function(){var n=" "+i.ns,r=t.isFullscreen?n+"fullscreen":"",s=null!=t.fx?n+"fx-"+t.fx:"",a=n+"type-"+i.type,c=null!=t.classMore?" "+t.classMore:"";i.wrapClass=r+s+a+c,i.$wrap.addClass(i.wrapClass);var l=t.margin;if(i.m=[0,0,0,0],o.isNum(l)&&(i.margin=[l,l,l,l]),e.isArray(l)&&o.isNum(l[0])&&o.isNum(l[1])&&o.isNum(l[2])&&o.isNum(l[3])&&(i.margin=l),i.isTs&&"zoom"==t.fx){var f=" "+t.speed/1e3+"s",u={};u[i.prefixTs+"transition"]=i.prefixTf+"transform"+f+", opacity"+f,u[i.prefixTf+"transform-origin"]="0 0",i.$outer.css(u)}}},a={codeMain:function(){var n=i.ns,r=t.html.main.replace(/\{ns\}/g,n);e("body").append(r),i.$wrap=e("."+n+"wrap"),i.$outer=e("."+n+"outer"),i.$inner=e("."+n+"inner"),i.$holder=e('<div class="'+n+'holder"></div>'),i.$close=e(t.html.close.replace(/\{ns\}/g,n)),a.appendToInner(),i.$wrap.detach()},beforeOpen:function(){"inline"==i.type&&i.$content.after(i.$holder).appendTo(i.$inner),i.$wrap.appendTo(e("body"))},afterClose:function(){i.$wrap.detach(),"inline"==i.type&&i.$holder.after(i.$content).detach()},appendToInner:function(){t.isBtnClose?i.$close.appendTo(i.$outer):i.$close.detach()}},c={beforeOpen:function(){var n=e(window).width();e("body").addClass(i.ns+"lock");var t=e(window).width();t>n&&e("body").addClass(i.ns+"lock-scroll"),i.screenW=t,i.screenH=e(window).height(),c.innerBeforeOpen()},innerBeforeOpen:function(){var e=t.width<=1?i.screenW*t.width:t.width,n=t.height<=1?i.screenH*t.height:t.height,r=i.margin;t.isFullscreen&&(e=i.screenW,n=i.screenH,r=[0,0,0,0]),i.screenW-e-r[1]-r[3]>=0?i.innerW=e:i.innerW=i.screenW-r[1]-r[3],i.screenH-n-r[0]-r[2]>=0?i.innerH=n:i.innerH=i.screenH-r[0]-r[2],i.outerX=Math.floor((i.screenW-i.innerW)/2),i.outerY=Math.floor((i.screenH-i.innerH)/2)},afterClose:function(){i.$wrap.removeClass(i.actived+i.classTemp),n.removeClass(i.actived),e("body").removeClass(i.ns+"lock "+i.ns+"lock-scroll")}},l={beforeOpen:function(){i.isTf3D&&"zoom"==t.fx?(i.linkW=n.outerWidth(),i.linkH=n.outerHeight(),i.linkWRatio=(i.linkW/i.innerW).toFixed(3),i.linkHRatio=(i.linkH/i.innerH).toFixed(3),i.linkX=Math.round(n.offset().left-e(window).scrollLeft()),i.linkY=Math.round(n.offset().top-e(window).scrollTop()),i.$inner.css({width:i.innerW,height:i.innerH}),i.tfLast=o.tf([i.linkX,i.linkY,i.linkWRatio,i.linkHRatio]),i.tfLast.opacity=0,i.$outer.css(i.tfLast),setTimeout(function(){var e=o.tf([i.outerX,i.outerY,1,1]);e.opacity=1,i.$outer.css(e)},4),clearTimeout(i.tiOpenFxAfter),i.tiOpenFxAfter=setTimeout(function(){i.ev.trigger("openFxAfter")},t.speed),l.backgroundFadeIn()):(i.$inner.css({width:i.innerW,height:i.innerH}),i.$outer.css({left:i.outerX,top:i.outerY}),i.ev.trigger("openFxAfter"))},afterClose:function(){return"zoom"==t.fx&&i.tfLast?(i.$outer.css(i.tfLast),l.backgroundFadeOut(),!0):!1},backgroundFadeIn:function(){setTimeout(function(){i.$wrap.addClass(i.ns+"fade-in")},4)},backgroundFadeOut:function(){i.$wrap.removeClass(i.ns+"fade-in")}},f={begin:function(){!!t.isLinkOpen&&n.on(i.evName.click,function(e){return u.open(),!1}),!!t.isOverClose&&i.$wrap.on(i.evName.click,function(n){n.target;e(n.target).is(i.$wrap)&&u.close()}),!!t.isBtnClose&&i.$close.on(i.evName.click,function(e){return u.close(),!1})},resizeOn:function(){e(window).on(i.evName.resize,function(e){clearTimeout(i.tiResize),i.tiResize=setTimeout(function(){u.updateLayout()},t.timerResize)})},resizeOff:function(){e(window).off(i.evName.resize)},keyboard:function(){e(document).off(i.evName.key),t.isKeyboard&&e(document).on(i.evName.key,function(e){i.isOpenedBox&&27==e.keyCode&&u.close()})}},u={open:function(){i.$wrap.hasClass(i.actived)||(i.ev.trigger("beforeOpen"),a.beforeOpen(),c.beforeOpen(),i.ev.trigger("openFxBefore"),l.beforeOpen(),n.addClass(i.actived),i.$wrap.addClass(i.actived+i.classTemp),f.resizeOn(),i.isOpenedBox=!0,i.ev.trigger("afterOpen"))},close:function(){if(i.$wrap.hasClass(i.actived)){var e=function(){i.ev.trigger("closeFxAfter"),a.afterClose(),c.afterClose(),f.resizeOff(),i.ev.trigger("afterClose"),i.isOpenedBox=!1};i.ev.trigger("beforeClose"),i.ev.trigger("closeFxBefore");var n=l.afterClose();n&&null!=t.fx?(clearTimeout(i.tiFxAfter),i.tiFxAfter=setTimeout(e,t.speed)):e()}},updateLayout:function(){s.vaUpdate(),c.beforeOpen(),l.beforeOpen()}};i=e.extend(i,u),e.data(n[0],rb01VA.codeName,i),r()},e.fn[rb01VA.codeName]=function(){var n=arguments,t=rb01VA.codeName,i=null;return e(this).each(function(){var r=e(this),o=r.data(t);if(void 0==n[0]&&(n[0]={}),"object"==typeof n[0])o||new e[t](r,e.extend(!0,{},e.fn[t].defaults,n[0])),i=r.data(t);else try{o[n[0]](n[1])}catch(s){!!window.console&&console.warn("["+t+": function not exist!]")}}),i},e.fn[rb01VA.codeName].defaults={type:"auto",href:null,content:null,title:null,classMore:null,minWidth:80,minHeight:80,width:600,height:400,margin:10,fx:"zoom",speed:300,timerResize:600,isInitOpen:!1,isTitle:!0,isFullscreen:!1,isBtnClose:!0,isOverClose:!0,isLinkOpen:!0,isKeyboard:!0,html:{main:"<div class='{ns}wrap'><div class='{ns}outer'><div class='{ns}inner'></div></div></div>",close:"<div class='{ns}btn-close' title='close'>close</div>"}}}(jQuery);