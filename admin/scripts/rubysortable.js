!function(e){"use-strict";window.rs20VA||(window.rs20VA={codeName:"rubysortable",codeData:"sortable",namespace:"rs20"}),e[rs20VA.codeName]=function(t,r){var a=rs20VA.namespace,n=a+Math.round(1e4*Math.random()),s={$items:null,$itemCur:null,$itemPrev:null,$itemNext:null,evSwipeBegin:"mousedown."+n,evSwipeMove:"mousemove."+n,evSwipeEnd:"mouseup."+n},o={},d={},m={isTransform3d:function(){var e,t=document.createElement("p"),r={webkitTransform:"-webkit-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(t,null);for(var a in r)void 0!==t.style[a]&&(t.style[a]="translate3d(1px,1px,1px)",e=window.getComputedStyle(t).getPropertyValue(r[a]));return document.body.removeChild(t),void 0!==e&&e.length>0&&"none"!==e},prefixVender:function(e,t){var r=document.createElement("p").style,a="Webkit Moz ms O".split(" "),n="-webkit- -moz- -ms- -o-".split(" ");if(""===r[e])return"is"==t?!0:"pre"==t?"":e;for(e=e.charAt(0).toUpperCase()+e.slice(1),i=a.length;i--;)if(""===r[a[i]+e])return"is"==t?!0:"pre"==t?n[i]:a[i]+e;return!1},transformDirection:function(e,t){var a,n=r.dragDirection;return o.animate?("ver"==n?e=0:"hor"==n&&(t=0),a=m.cssTf(e,t)):("ver"==n?e="":"hor"==n&&(t=""),a={left:e,top:t}),a},setupItemData:function(e){var t=e.outerWidth(),r=e.outerHeight(),a=e.position().left-s.padLeftOfcode,n=e.position().top-s.padTopOfCode,o=m.r(t/2+a),i=m.r(r/2+n);return{$item:e,left:a,top:n,xCenter:o,yCenter:i,tf:m.cssTf(a,n)}},findItemReplace:function(){var e,t=(s.$itemCur.data(),s.leftCur),r=s.topCur,a=s.wItemCur,n=s.hItemCur,o=(t+m.r(a/2),r),i=t+a,d=(r+m.r(n/2),r+n),u=t,f=s.$itemArea,c=f.top,l=f.right,g=f.bottom,p=f.left;return c&&o<c.data("yCenter")?e=c:l&&i>l.data("xCenter")?e=l:g&&d>g.data("yCenter")?e=g:p&&u<p.data("xCenter")&&(e=p),e},holderInsertAtBegin:function(){var e=s.$itemCur,t=s.$items.not(e).first(),r={display:t.css("display"),"float":t.css("float"),width:s.wItemCur,height:s.hItemCur,margin:e.css("margin-top")+" "+e.css("margin-right")+" "+e.css("margin-bottom")+" "+e.css("margin-left")};s.$holder.css(r).data(e.data()),o.animate&&s.$holder.css(e.data("tf")),s.$itemCur.after(s.$holder)},moveHolderToReplace:function(t){var r=e("<div/>");if(s.$holder.after(r),t.after(s.$holder),r.after(t).remove(),o.animate){var a=s.$holder.data("tf"),n=t.data("tf");setTimeout(function(){s.$holder.css(n),t.css(a)},4)}var i=s.$holder.data(),d=t.data();i={left:i.left,top:i.top,xCenter:i.xCenter,yCenter:i.yCenter,tf:i.tf},d={left:d.left,top:d.top,xCenter:d.xCenter,yCenter:d.yCenter,tf:d.tf},s.$holder.data(d),t.data(i)},ns:function(e){return e.replace(/\{ns\}/g,a)},r:function(e){return Math.round(e)},pInt:function(e){return/^\-?\d+/g.test(e)?parseInt(e,10):0},cssTf:function(e,t){var r={},a="translate3d({x}px, {y}px, 0)".replace(/\{x\}/,e).replace(/\{y\}/,t);return r[s.vender+"transform"]=a,r},resetTf:function(){var e={};return e[s.vender+"transform"]="",e}},u={itemsAndZoneDrag:function(){var a="."+m.ns(r.classItem),n="_self_"==r.classZoneDrag?a:"."+m.ns(r.classZoneDrag);s.$items=t.find(a),s.$zoneDrag=t.find(n),s.num=s.$items.length,s.$zoneDrag.each(function(){e(this).data("$item",e(this).closest(a))})},codeHeight:function(){t.css("height",t.height())},posAllItemAtBegin:function(r){var n=a+"relative";t.addClass(n),r||(r=e("")),s.padLeftOfcode=m.pInt(t.css("padding-left")),s.padTopOfCode=m.pInt(t.css("padding-top")),o.animate||(s.padLeftOfcode=s.padTopOfCode=0),s.aPosItems=[],s.$items.each(function(){var t=e(this),a=m.setupItemData(t);t.is(s.$itemCur)||(s.aPosItems.push(a),o.animate&&!t.is(r)&&t.css(a.tf)),t.data(a)}),t.removeClass(n)},posAllItemAtMove:function(){var t=s.$itemCur;s.aPosItems=[],s.$items.each(function(){var r=e(this);r.is(t)||s.aPosItems.push(r.data())})},findItemInOneDirs:function(e){for(var t,r=s.$holder.data(),a=Number.MAX_VALUE,n=a,o=a,i=[],d=e.dirs+"Center",m=e.sign,u=0,f=s.aPosItems.length;f>u;u++){var c=s.aPosItems[u];(r[d]+e.plus)*m>c[d]*m&&i.push(c)}var l=i.length;if(l)for(var u=0;l>u;u++){var g=Math.abs(r.xCenter-i[u].xCenter),p=Math.abs(r.yCenter-i[u].yCenter);n+2>=g&&o+2>=p&&(n=g,o=p,t=i[u].$item)}return t},posAndItemInArea:function(){s.$itemArea={top:u.findItemInOneDirs({dirs:"y",sign:1,plus:-10}),bottom:u.findItemInOneDirs({dirs:"y",sign:-1,plus:10}),left:u.findItemInOneDirs({dirs:"x",sign:1,plus:-10}),right:u.findItemInOneDirs({dirs:"x",sign:-1,plus:10})}}},f={dragBegin:function(r){var a=s.$itemCur;d.ev.trigger("dragBegin"),u.posAllItemAtBegin(),o.animate&&u.codeHeight(),t.addClass(s.classDragging),s.wItemCur=a.outerWidth(),s.hItemCur=a.outerHeight(),s.xTapLast=r.pageX,s.yTapLast=r.pageY,s.leftCur=a.data("left"),s.topCur=a.data("top"),a.css({width:m.r(a.width()),height:m.r(a.height())}).css(m.transformDirection(s.leftCur,s.topCur)).addClass(s.classCur),m.holderInsertAtBegin(),u.posAndItemInArea(),e(document).on(s.evSwipeMove,function(e){f.dragMove(e)}),e(document).one(s.evSwipeEnd,function(e){f.dragEnd(e)})},dragMove:function(e){var t=s.$itemCur,r=e.pageX-s.xTapLast,a=e.pageY-s.yTapLast;s.leftCur=t.data("left")+r,s.topCur=t.data("top")+a,t.css(m.transformDirection(s.leftCur,s.topCur));var n=m.findItemReplace();n&&(m.moveHolderToReplace(n),u.posAllItemAtMove(),u.posAndItemInArea(),d.ev.trigger("itemSwap"))},dragEnd:function(r){s.$itemCur.removeClass(s.classCur).css({width:"",height:""}).css(o.animate?s.$holder.data("tf"):{left:"",top:""}).data(s.$holder.data()),s.$holder.after(s.$itemCur),s.$holder.css("display","none"),setTimeout(function(){s.$holder.removeAttr("style").detach()},10),o.animate&&(s.$items.css(m.resetTf()),t.css("height","")),t.removeClass(s.classDragging),e(document).off(s.evSwipeMove),d.ev.trigger("dragEnd")},dragON:function(){s.$zoneDrag.on(s.evSwipeBegin,function(t){s.$itemCur=e(this).data("$item"),f.dragBegin(t)})},dragOFF:function(){s.$items.off("mousedown."+n),e(document).off("mousemove."+n),e(document).off("mouseup."+n)}},c={dragON:function(){o.dragging||(u.itemsAndZoneDrag(),s.num&&s.num>1&&(o.dragging=!0,d.ev.trigger("dragON"),f.dragON()))},dragOFF:function(){s.num&&(o.dragging=!1,f.dragOFF(),d.ev.trigger("dragOFF"))},update:function(){u.itemsAndZoneDrag(),s.num&&s.num>1&&(c.dragOFF(),c.dragON()),d.ev.trigger("update")},ev:e("<div/>")},l=function(){s.vender=m.prefixVender("transform","pre"),s.classCur=a+r.classCur,s.classDragging=a+r.classDragging,s.$holder=e("<div/>",{"class":a+r.classHolder,html:"&nbsp;"}),o.tf=m.isTransform3d(),o.animate=r.isAnimate&&o.tf,t[o.animate?"addClass":"removeClass"](a+"animate"),d=e.extend(!0,d,c),e.data(t[0],rs20VA.codeName,d),c.dragON()};l()},e.fn[rs20VA.codeName]=function(){var t=arguments;return codeName=rs20VA.codeName,codeData=null,e(this).each(function(){var r=e(this),a=r.data(codeName);if(void 0==t[0]&&(t[0]={}),e.isPlainObject(t[0])&&!a){var n=e.fn[codeName].defaults,s=r.data(rs20VA.codeData);void 0==s?s={}:r.removeAttr("data-"+rs20VA.codeData);var o=e.extend(!0,{},n,t[0],s);new e[codeName](r,o),codeData=r.data(codeName)}}),codeData},e.fn[rs20VA.codeName].defaults={classZoneDrag:"_self_",classItem:"{ns}item",classCur:"cur",classDragging:"dragging",classHolder:"holder",dragDirection:"auto",isAnimate:!0}}(jQuery);